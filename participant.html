<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Participant Verification</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2em;
      max-width: 500px;
      margin: auto;
    }
    label, input {
      display: block;
      margin: 1em 0;
    }
    input[type="text"] {
      padding: 0.5em;
      width: 100%;
      font-size: 16px;
    }
    button {
      padding: 0.6em 1.2em;
      font-size: 16px;
      cursor: pointer;
    }
    #result {
      margin-top: 1em;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Welcome</h2>
  <p id="welcomeMessage"></p>

  <label for="dobInput">Enter your Date of Birth (dd/mm/yyyy):</label>
  <input type="text" id="dobInput" placeholder="dd/mm/yyyy" maxlength="10" />
  <button onclick="verifyDOB()">Submit</button>

  <div id="result"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const name = params.get("name") || "Participant";
    const dob = params.get("dob") || "";

    document.getElementById("welcomeMessage").textContent = `Hello ${name}, please verify your date of birth.`;

    // Auto-insert slashes as the user types DOB
    const dobInput = document.getElementById("dobInput");
    dobInput.addEventListener("input", (e) => {
      let value = e.target.value.replace(/\D/g, ""); // remove non-digits
      if (value.length > 2) value = value.slice(0, 2) + "/" + value.slice(2);
      if (value.length > 5) value = value.slice(0, 5) + "/" + value.slice(5, 9);
      e.target.value = value;
    });

    function verifyDOB() {
      const inputDob = dobInput.value.trim();
      const resultDiv = document.getElementById("result");

      if (inputDob === dob) {
        // ✅ DOB is correct – redirect to select.html
        const redirectUrl = `select.html?name=${encodeURIComponent(name)}&dob=${encodeURIComponent(inputDob)}`;
        window.location.href = redirectUrl;
      } else {
        // ❌ DOB is incorrect – show error
        resultDiv.innerHTML = "<p style='color:red;'>Incorrect DOB. Try again.</p>";
      }
    }
  </script>
</body>
</html>
